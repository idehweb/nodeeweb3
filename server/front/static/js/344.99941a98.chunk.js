"use strict";(self.webpackChunkgomrok24=self.webpackChunkgomrok24||[]).push([[344],{95344:(e,t,s)=>{s.r(t),s.d(t,{default:()=>P});var a=s(8869),r=s(75590),o=s(2135),n=s(58467),i=s(71640),l=s(47313),h=s(82036),c=s(85281),d=s(61708),m=s(23148),u=function(){return u=Object.assign||function(e){for(var t,s=1,a=arguments.length;s<a;s++)for(var r in t=arguments[s])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},u.apply(this,arguments)};function p(){for(var e=0,t=0,s=arguments.length;t<s;t++)e+=arguments[t].length;var a=Array(e),r=0;for(t=0;t<s;t++)for(var o=arguments[t],n=0,i=o.length;n<i;n++,r++)a[r]=o[n];return a}var g=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],x=["1","2","3","4","5","6","7","8","9"],f=[4,5,6,7,8];function v(e,t){var s=l.useState(),a=s[0],r=s[1];return l.useEffect((function(){if(e.current){var s=t.type,a=void 0===s?"mixed":s,o=t.length,n=void 0===o?5:o,i=t.sensitive,l=void 0!==i&&i,h=t.width,c=void 0===h?200:h,d=t.height,m=void 0===d?50:d,u=t.fontColor,v=void 0===u?"#000":u,j=t.background,b=void 0===j?"rgba(255, 255, 255, .2)":j;f.includes(n)||(n=5);var N=e.current,y=[],C="";switch(a){case"numeric":y=p(x);break;case"mixed":y=p(g,x);break;default:y=p(g)}r({gen:function(){var e=document.getElementById("offline-captcha-canvas-area");e&&N.removeChild(e);var t=document.createElement("canvas");t.width=c,t.height=m,t.setAttribute("id","offline-captcha-canvas-area"),t.setAttribute("style","border: 1px solid black; background: "+b),N.appendChild(t);var s=t.getContext("2d");C=function(e){for(var t,s=e.length-1;s>0;s--){var a=Math.floor(Math.random()*(s+1));t=[e[a],e[s]],e[s]=t[0],e[a]=t[1]}return e.slice(0,n)}(y).join(""),function(e){for(var a=["Arial","Georgia","Helvetica","Impact"],r=0;r<e.length;r++){var o=c/e.length;s.font="2em "+a[k(0,a.length-1)],s.fillStyle=v,s.fillText(e[r],5+r*o,k(30,t.height-10),200)}}(C),["darkgray","red","darkblue"].forEach((function(e){return function(e){s.beginPath(),s.moveTo(0,10+Math.random()*t.height),s.lineTo(t.width,10+Math.random()*t.height),s.lineWidth=1*Math.random()+1,s.closePath(),s.strokeStyle=e,s.stroke()}(e)}))},validate:function(e){return!!new RegExp(C,l?"g":"gi").test(e)}})}function k(e,t){return Math.floor(Math.random()*(t-e+1)+e)}}),[]),u({},a)}var j=s(46417);const b=e=>{let{onActionSubmit:t,onActionValue:s}=e;const r=(0,l.useRef)(),[o,n]=(0,l.useState)(),{gen:i,validate:h}=v(r,{type:"numeric",length:6,sensitive:!1,width:130,height:30,fontColor:"#000",background:"rgba(255, 255, 255, .2)"});(0,l.useEffect)((()=>{i&&i()}),[i]);return(0,j.jsxs)(a.X2,{children:[(0,j.jsx)(a.JX,{xs:6,style:{maxWidth:"140px"},children:(0,j.jsx)("div",{ref:r})}),(0,j.jsx)(a.JX,{xs:6,style:{width:"calc(100% - 140px)"},children:(0,j.jsx)("input",{onChange:e=>{n(e.target.value),t(h(e.target.value)),s(e.target.value)},value:o})})]})},N=(0,l.memo)(b);var y=s(66978);const C=120;class k extends l.Component{constructor(e){var t;super(e),t=this,this.handleSendCodeAgain=e=>{this.handleRegister=e},this.handleRegister=e=>{e.preventDefault();let t=this.state.countryCode||"98",s=this.state.phoneNumber||"0",a=this.state.captcha;if(!s||""==s||0==s)return void(0,h.Am)("\u0644\u0637\u0641\u0627 \u0634\u0645\u0627\u0631\u0647 \u0645\u0648\u0628\u0627\u06cc\u0644 \u062e\u0648\u062f \u0631\u0627 \u0648\u0627\u0631\u062f \u06a9\u0646\u06cc\u062f",{type:"error"});if(!a||0==a||"undefined"==a)return void(0,h.Am)("\u0644\u0637\u0641\u0627 \u0641\u06cc\u0644\u062f \u06a9\u067e\u0686\u0627 \u0631\u0627 \u0648\u0627\u0631\u062f \u06a9\u0646\u06cc\u062f",{type:"error"});s=s.substring(s.length-10),this.setState({thePhoneNumber:s,countryCode:t,phoneNumber:s});let r=t+(0,y.dv)(s);(0,d.z2)(r,t,this.state.loginMethod).then((e=>{e.shallWeSetPass?(this.state.timer=C,this.myInterval=setInterval((()=>{this.setState((e=>{let{timer:t}=e;return{timer:t>0?t-1:this.handleClearInterval()}}))}),1e3),this.setState({enterActivationCodeMode:!0,activationCode:null,isDisplay:!1})):!e.shallWeSetPass&&e.userWasInDbBefore&&this.setState({isDisplay:!1,getPassword:!0})}))},this.handleClearInterval=()=>(clearInterval(this.myInterval),0),this.handlePassword=e=>{e.preventDefault();let t=(this.state.countryCode||"98")+this.state.phoneNumber;(0,d.di)({phoneNumber:t,password:this.state.password}).then((e=>{e.success?this.props&&this.props.goToCheckout?this.setState({token:e.customer.token,firstName:e.customer&&e.customer.firstName?e.customer.firstName:null,lastName:e.customer&&e.customer.lastName?e.customer.lastName:null,goToCheckout:!0}):this.setState({token:e.customer.token,goToProfile:!0}):e.message&&alert(e.message)})).catch((e=>{(0,h.Am)(this.props.t(e.message),{type:"error"})}))},this.handleForgotPass=e=>{e.preventDefault();let t=this.state.countryCode||"98",s=this.state.phoneNumber||"0",a=t+(0,y.dv)(s);(0,d.gM)(a,t,this.state.loginMethod).then((e=>{this.setState({enterActivationCodeMode:!0,isDisplay:!1,getPassword:!1,firstName:e.firstName,lastName:e.lastName}),this.state.timer=C,this.myInterval=setInterval((()=>{this.setState((e=>{let{timer:t}=e;return{timer:t>0?t-1:this.handleClearInterval()}}))}),1e3)}))},this.handleWrongPhoneNumber=e=>{this.handleClearInterval(),e.preventDefault(),this.setState({phoneNumber:null,activationCode:null,enterActivationCodeMode:!1,showSecondForm:!1,isDisplay:!0,setPassword:!1,getPassword:!1,goToProfile:!1,timer:C})},this.savePasswordAndData=e=>{e.preventDefault();const{countryCode:t,phoneNumber:s,firstName:a,lastName:r,email:o,password:n,address:i}=this.state,{t:l}=this.props;let c=t||"98";function m(e){return!!/^[\u0600-\u06FF\s]+$/.test(e)}a&&""!=a&&r&&""!=r&&n&&void 0!=n&&""!=n?m(a)?m(r)?(0,d.AD)({phoneNumber:c+s,firstName:a,lastName:r,address:i,email:o,password:n}).then((e=>{(e.success||e.firstName&&e.lastName)&&this.setState({setPassword:!1,goToProfile:!0})})):(0,h.Am)(l("Enter last name in persian!"),{type:"error"}):(0,h.Am)(l("Enter first name in persian!"),{type:"error"}):(0,h.Am)(l("fill everything!"),{type:"error"})},this.handleActivation=e=>{e.preventDefault();let{activationCode:s,countryCode:a,phoneNumber:r="0"}=this.state,{t:o}=this.props;a||(a="98"),s||alert("enter activation code!");let n={activationCode:s,phoneNumber:a+(0,y.dv)(r)};(0,d.bB)(n).then((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.success)return h.Am.error(o(e.message));if(e.firstName&&e.lastName)return h.Am.success(o("welcome")),void(window.location.href="/");if(e.shallWeSetPass){let s={token:e.token,enterActivationCodeMode:!1,setPassword:!0,firstName:e.firstName,lastName:e.lastName};t.setState(s)}else t.setState({token:e.token})}))};let s=m.ZP.getState().store,a=!1;!s.user.token||s.user.firstName&&s.user.lastName||(a=!0),this.state={captcha:!1,phoneNumber:null,thePhoneNumber:null,activationCode:null,enterActivationCodeMode:!1,showSecondForm:!1,isDisplay:!a,setPassword:a,countryCode:s.countryCode,getPassword:!1,firstName:s.user.firstName,lastName:s.user.lastName,email:"",goToProfile:!1,loginMethod:"sms",token:s.user.token,CameFromPost:s.CameFromPost,goToProduct:s.goToProduct,goToCheckout:s.goToCheckout,goToChat:s.goToChat,timer:C},window.scrollTo(0,0),this.captchaAction=this.captchaAction.bind(this)}fd(e){(0,d.SR)(e)}fc(e){(0,d.lY)(e)}checkResponse(e){this.setState({loginMethod:e})}componentDidMount(){}componentWillUnmount(){clearInterval(this.myInterval)}captchaValue(e){}captchaAction(e){!0===e&&this.setState({captcha:!0})}render(){const{isDisplay:e,goToProfile:t,token:s,firstName:r,lastName:o,CameFromPost:i,goToProduct:l,setPassword:h,getPassword:m,enterActivationCodeMode:u,goToCheckout:p,goToChat:g,loginMethod:x,timer:f}=this.state,{t:v,fromPage:b}=this.props;return s&&l?(this.fc(!1),(0,j.jsx)(n.Fg,{to:"/submit-order/"+l})):s&&p&&r&&o&&!h?((0,d.TJ)({goToCheckout:!1}),(0,j.jsx)(n.Fg,{to:"/checkout/"})):s&&!p&&b&&!h?((0,d.TJ)({goToCheckout:!1}),(0,j.jsx)(n.Fg,{to:b+"/"})):s&&g?((0,d.TJ)({goToChat:!1}),(0,j.jsx)(n.Fg,{to:"/chat/"})):s&&i&&!h?(this.fd(!1),(0,j.jsx)(n.Fg,{to:"/add-new-post/publish"})):s&&!i&&!h&&r&&o||t?(0,j.jsx)(n.Fg,{to:"/profile"}):(0,j.jsxs)(a.NX,{flush:!0,children:[e&&(0,j.jsx)(a.WI,{className:"p-3",children:(0,j.jsx)(a.X2,{children:(0,j.jsx)(a.JX,{children:(0,j.jsxs)(a.l0,{onSubmit:this.handleRegister,children:[(0,j.jsx)(a.X2,{form:!0,children:(0,j.jsxs)(a.JX,{md:"12",className:"form-group ltr",children:[(0,j.jsx)("label",{htmlFor:"thepho",children:v("phone number")}),(0,j.jsxs)(a.BZ,{className:"mb-3",children:[(0,j.jsx)(a.wF,{type:"prepend",children:(0,j.jsx)(a.ih,{onChange:e=>this.setState({countryCode:e.target.value}),children:(0,j.jsx)("option",{value:"98",children:"+98"})})}),(0,j.jsx)(a.yt,{placeholder:"**********",id:"thepho",className:"iuygfghuji",type:"tel",dir:"ltr",onChange:e=>this.setState({phoneNumber:e.target.value})})]}),(0,j.jsx)(N,{onActionValue:this.captchaValue,onActionSubmit:this.captchaAction})]})}),(0,j.jsx)(a.X2,{form:!0}),(0,j.jsx)(a.zx,{block:!0,type:"submit",className:"center",onClick:this.handleRegister,children:v("get enter code")})]})})})}),u&&(0,j.jsx)(a.WI,{className:"p-3",children:(0,j.jsx)(a.X2,{children:(0,j.jsx)(a.JX,{children:(0,j.jsxs)(a.l0,{onSubmit:this.handleActivation,children:[(0,j.jsx)(a.X2,{form:!0,children:(0,j.jsxs)(a.JX,{md:"12",className:"form-group",children:[(0,j.jsxs)("div",{className:"your-phone-number d-flex justify-content-sb",children:[(0,j.jsx)("div",{className:"flex-item ",children:v("your phone number")+":"}),(0,j.jsx)("div",{className:"flex-item ltr",children:"+"+this.state.countryCode+this.state.thePhoneNumber})]}),(0,j.jsx)("div",{className:"your-timer",children:(0,j.jsx)("div",{className:"flex-item ",children:Boolean(f)&&(0,j.jsxs)("div",{className:"flex-item-relative center ",children:[(0,j.jsx)(c.Z,{className:"red-progress",thickness:2,size:120,variant:"determinate",value:parseInt(100*f/C)}),(0,j.jsx)("div",{className:"flex-item-absolute ",children:f})]})})}),(0,j.jsx)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"start"},children:(0,j.jsx)("label",{style:{fontSize:12},htmlFor:"feEmailAddress",children:v("enter sent code")})}),(0,j.jsx)(a.BZ,{className:"mb-3",children:(0,j.jsx)(a.yt,{placeholder:"_ _ _ _ _ _",type:"number",className:"iuygfghuji",dir:"ltr",onChange:e=>{this.setState({activationCode:e.target.value})}})})]})}),(0,j.jsx)(a.X2,{form:!0,children:(0,j.jsx)(a.JX,{md:"12",className:"form-group"})}),(0,j.jsx)(a.zx,{block:!0,type:"submit",className:"center",onClick:this.handleActivation,children:v("login")}),(0,j.jsx)(a.zx,{outline:!0,type:"button",className:"center btn-block outline the-less-important",onClick:this.handleWrongPhoneNumber,children:v("Wrong phone number?")}),Boolean(!f)&&(0,j.jsx)("div",{className:"flex-item-relative center ",children:(0,j.jsx)(a.zx,{outline:!0,type:"button",className:"center btn-block outline the-less-important the-no-border",onClick:e=>this.handleRegister(e),children:v("Send code again?")})})]})})})}),h&&(0,j.jsx)(a.WI,{className:"p-3",children:(0,j.jsx)(a.X2,{children:(0,j.jsx)(a.JX,{children:(0,j.jsxs)(a.l0,{onSubmit:this.savePasswordAndData,children:[(0,j.jsxs)(a.X2,{form:!0,children:[(0,j.jsxs)(a.JX,{md:"12",className:"form-group",children:[(0,j.jsx)("label",{htmlFor:"olfirstname",children:v("Your first name")}),(0,j.jsx)(a.BZ,{className:"mb-3",children:(0,j.jsx)(a.yt,{placeholder:v("First name (persian)"),type:"text",id:"olfirstname",dir:"rtl",value:r,onChange:e=>this.setState({firstName:e.target.value})})})]}),(0,j.jsxs)(a.JX,{md:"12",className:"form-group",children:[(0,j.jsx)("label",{htmlFor:"ollastname",children:v("Your last name")}),(0,j.jsx)(a.BZ,{className:"mb-3",children:(0,j.jsx)(a.yt,{placeholder:v("Last name (persian)"),type:"text",value:o,id:"ollastname",dir:"rtl",onChange:e=>this.setState({lastName:e.target.value})})})]}),(0,j.jsxs)(a.JX,{md:"12",className:"form-group",children:[(0,j.jsx)("label",{htmlFor:"oiuytpaswword",children:v("set new password")}),(0,j.jsx)(a.BZ,{className:"mb-3",children:(0,j.jsx)(a.yt,{placeholder:"******",type:"password",id:"oiuytpaswword",dir:"ltr",onChange:e=>this.setState({password:e.target.value})})})]})]}),(0,j.jsx)(a.X2,{form:!0,children:(0,j.jsx)(a.JX,{md:"12",className:"form-group"})}),(0,j.jsx)(a.zx,{type:"submit",className:"center btn-block",onClick:this.savePasswordAndData,children:v("Register")}),(0,j.jsx)(a.zx,{type:"submit",className:"center btn-block",onClick:d.RD,children:v("Logout")})]})})})}),m&&(0,j.jsx)(a.WI,{className:"p-3",children:(0,j.jsx)(a.X2,{children:(0,j.jsx)(a.JX,{children:(0,j.jsxs)(a.l0,{onSubmit:this.handlePassword,children:[(0,j.jsx)(a.X2,{form:!0,children:(0,j.jsxs)(a.JX,{md:"12",className:"form-group",children:[(0,j.jsx)("div",{className:"your-phone-number d-flex justify-content-sb",children:(0,j.jsx)("div",{className:"mb-2 flex-item",children:v("You registered before, please enter your password.")})}),(0,j.jsxs)("div",{className:"your-phone-number d-flex justify-content-sb",children:[(0,j.jsx)("div",{className:"flex-item ",children:v("your phone number")+":"}),(0,j.jsx)("div",{className:"flex-item ltr",children:"+"+this.state.countryCode+this.state.thePhoneNumber})]}),(0,j.jsx)("label",{htmlFor:"oiuytgpaswword",children:v("Enter password")}),(0,j.jsx)(a.BZ,{className:"mb-3",children:(0,j.jsx)(a.yt,{placeholder:"******",type:"password",id:"oiuytgpaswword",dir:"ltr",onChange:e=>this.setState({password:e.target.value})})})]})}),(0,j.jsx)(a.X2,{form:!0,children:(0,j.jsx)(a.JX,{md:"12",className:"form-group"})}),(0,j.jsx)(a.zx,{block:!0,type:"submit",className:"center",onClick:this.handlePassword,children:v("Login")}),(0,j.jsx)(a.zx,{type:"button",className:"center btn-block",onClick:this.handleForgotPass,children:v("Forgot Password")}),(0,j.jsx)(a.zx,{outline:!0,type:"button",className:"center btn-block outline the-less-important",onClick:this.handleWrongPhoneNumber,children:v("Wrong phone number?")})]})})})})]})}}const w=(0,r.Zh)()(k);function P(){const{t:e}=(0,r.$G)(),[t]=(0,o.lr)(),s=(0,n.UO)(),l=t.get("fromPage");return"goToCheckout"===s._state&&(0,d.TJ)({goToCheckout:!0}),"goToChat"===s._state&&(0,d.TJ)({goToChat:!0}),(0,j.jsxs)(a.W2,{fluid:!0,className:"main-content-container px-4",children:[(0,j.jsx)(a.X2,{noGutters:!0,className:"page-header py-4",children:(0,j.jsx)(i.Z,{sm:"12",title:e("login / register"),subtitle:e("user account"),className:"text-sm-left"})}),(0,j.jsx)("div",{className:"w-100",children:(0,j.jsx)(a.JX,{lg:"4",className:"mx-auto mb-4",children:(0,j.jsx)(a.Zb,{children:(0,j.jsx)(w,{goToCheckout:"goToCheckout"===s._state,fromPage:l})})})})]})}}}]);