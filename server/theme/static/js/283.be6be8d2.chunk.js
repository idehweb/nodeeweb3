"use strict";(self.webpackChunkgomrok24=self.webpackChunkgomrok24||[]).push([[283],{62283:(e,t,s)=>{s.r(t),s.d(t,{default:()=>f});var a=s(8869),o=s(75590),r=s(2135),l=s(58467),i=s(71640),n=s(47313),d=s(82036),h=s(85281),c=s(61708),m=s(23148),u=s(66978),p=s(46417);const x=120;class g extends n.Component{constructor(e){var t,s,a;super(e),t=this,this.handleSendCodeAgain=e=>{this.handleRegister=e},this.handleRegister=e=>{e.preventDefault();let t=this.state.countryCode||"98",s=this.state.phoneNumber||"0";this.state.captcha;if(!s||""==s||0==s)return void(0,d.Am)("\u0644\u0637\u0641\u0627 \u0634\u0645\u0627\u0631\u0647 \u0645\u0648\u0628\u0627\u06cc\u0644 \u062e\u0648\u062f \u0631\u0627 \u0648\u0627\u0631\u062f \u06a9\u0646\u06cc\u062f",{type:"error"});s=s.substring(s.length-10),this.setState({thePhoneNumber:s,countryCode:t,phoneNumber:s});let a=t+(0,u.dv)(s);(0,c.z2)(a,t,this.state.loginMethod).then((e=>{e.shallWeSetPass?(this.state.timer=x,this.myInterval=setInterval((()=>{this.setState((e=>{let{timer:t}=e;return{timer:t>0?t-1:this.handleClearInterval()}}))}),1e3),this.setState({enterActivationCodeMode:!0,activationCode:null,isDisplay:!1,userWasInDbBefore:null===e||void 0===e?void 0:e.userWasInDbBefore})):!e.shallWeSetPass&&e.userWasInDbBefore&&this.setState({isDisplay:!1,getPassword:!0,userWasInDbBefore:null===e||void 0===e?void 0:e.userWasInDbBefore})}))},this.handleClearInterval=()=>(clearInterval(this.myInterval),0),this.handlePassword=e=>{e.preventDefault();let t=(this.state.countryCode||"98")+this.state.phoneNumber;(0,c.di)({phoneNumber:t,password:this.state.password}).then((e=>{e.success?this.props&&this.props.goToCheckout?this.setState({token:e.customer.token,firstName:e.customer&&e.customer.firstName?e.customer.firstName:null,lastName:e.customer&&e.customer.lastName?e.customer.lastName:null,goToCheckout:!0}):this.setState({token:e.customer.token,goToProfile:!0}):e.message&&alert(e.message)})).catch((e=>{(0,d.Am)(this.props.t(e.message),{type:"error"})}))},this.handleForgotPass=e=>{e.preventDefault();let t=this.state.countryCode||"98",s=this.state.phoneNumber||"0",a=t+(0,u.dv)(s);(0,c.gM)(a,t,this.state.loginMethod).then((e=>{this.setState({enterActivationCodeMode:!0,isDisplay:!1,getPassword:!1,firstName:e.firstName,lastName:e.lastName}),this.state.timer=x,this.myInterval=setInterval((()=>{this.setState((e=>{let{timer:t}=e;return{timer:t>0?t-1:this.handleClearInterval()}}))}),1e3)}))},this.handleWrongPhoneNumber=e=>{this.handleClearInterval(),e.preventDefault(),this.setState({phoneNumber:null,activationCode:null,enterActivationCodeMode:!1,showSecondForm:!1,isDisplay:!0,setPassword:!1,getPassword:!1,goToProfile:!1,timer:x})},this.savePasswordAndData=e=>{e.preventDefault();const{countryCode:t,phoneNumber:s,firstName:a,lastName:o,email:r,registerExtraFields:l,password:i,extraFields:n,internationalCode:h,internationalCodeClass:m,address:u}=this.state,{t:p}=this.props;let x=u;x||(x=[]);let g=t||"98";if(a&&""!=a)if(o&&""!=o)if(!this.state.passwordAuthentication||i&&void 0!=i&&""!=i){if(l)for(let e=0;e<=(null===l||void 0===l?void 0:l.length);e++){var v,f;let t=null===(v=l[e])||void 0===v?void 0:v.name,s=null===(f=l[e])||void 0===f?void 0:f.require;if(s&&"address"==t){let e={StreetAddress:n[t]};n.PostalCode&&(e.PostalCode=n.PostalCode),n.postalCode&&(e.PostalCode=n.postalCode),n.postalcode&&(e.PostalCode=n.postalcode),x.push(e)}if(s&&"internationalCode"==t){if(!n[t]||void 0==n[t]||""==n[t])return void(0,d.Am)(p("fill internationalCode!"),{type:"error"});if(!m||void 0==m||""==m){if(!h)return void(0,d.Am)(p("fill internationalCode!"),{type:"error"});if(!(0,c.zu)(h))return void(0,d.Am)(p("fill internationalCode!"),{type:"error"})}}if(s&&"internationalCode"!==t&&"address"!==t&&(!n[t]||void 0==n[t]||""==n[t]))return void(0,d.Am)(p("fill every thing!"),{type:"error"})}N(a)?N(o)?(0,c.AD)({phoneNumber:g+s,firstName:a,lastName:o,address:x,email:r,data:n,internationalCode:h,password:i}).then((e=>{(e.success||e.firstName&&e.lastName)&&this.setState({setPassword:!1,goToProfile:!0})})):(0,d.Am)(p("Enter last name in persian!"),{type:"error"}):(0,d.Am)(p("Enter first name in persian!"),{type:"error"})}else(0,d.Am)(p("fill everything!"),{type:"error"});else(0,d.Am)(p("fill everything!"),{type:"error"});else(0,d.Am)(p("fill everything!"),{type:"error"});function N(e){return!!/^[\u0600-\u06FF\s]+$/.test(e)}},this.handleActivation=e=>{e.preventDefault();let{activationCode:s,countryCode:a,phoneNumber:o="0"}=this.state,{t:r}=this.props;a||(a="98"),s||alert("enter activation code!");let l={activationCode:s,phoneNumber:a+(0,u.dv)(o)};(0,c.bB)(l).then((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.success)return d.Am.error(r(e.message));if(e.success&&d.Am.success(r("welcome")),e.shallWeSetPass){let s={token:e.token,enterActivationCodeMode:!1,setPassword:!0,firstName:e.firstName,lastName:e.lastName};t.setState(s)}else t.state.userWasInDbBefore?t.setState({token:null===e||void 0===e?void 0:e.token,enterActivationCodeMode:!1,setPassword:!1,firstName:null===e||void 0===e?void 0:e.firstName,lastName:null===e||void 0===e?void 0:e.lastName}):t.setState({token:null===e||void 0===e?void 0:e.token,enterActivationCodeMode:!1,setPassword:!0,firstName:null===e||void 0===e?void 0:e.firstName,lastName:null===e||void 0===e?void 0:e.lastName})}))};let o=m.ZP.getState().store,r=!1;!o.user.token||o.user.firstName&&o.user.lastName||(r=!0),this.state={captcha:!1,phoneNumber:null,thePhoneNumber:null,activationCode:null,enterActivationCodeMode:!1,showSecondForm:!1,userWasInDbBefore:!0,isDisplay:!r,setPassword:r,countryCode:o.countryCode,getPassword:!1,firstName:o.user.firstName,lastName:o.user.lastName,passwordAuthentication:null===o||void 0===o||null===(s=o.themeData)||void 0===s?void 0:s.passwordAuthentication,registerExtraFields:null===o||void 0===o||null===(a=o.themeData)||void 0===a?void 0:a.registerExtraFields,extraFields:{},internationalCodeClass:(0,c.zu)(o.user.internationalCode)?"true":null,internationalCode:o.user.internationalCode,email:"",goToProfile:!1,loginMethod:"sms",token:o.user.token,CameFromPost:o.CameFromPost,goToProduct:o.goToProduct,goToCheckout:o.goToCheckout,goToChat:o.goToChat,timer:x},window.scrollTo(0,0),this.captchaAction=this.captchaAction.bind(this)}fd(e){(0,c.SR)(e)}fc(e){(0,c.lY)(e)}checkResponse(e){this.setState({loginMethod:e})}componentDidMount(){}componentWillUnmount(){clearInterval(this.myInterval)}captchaValue(e){}captchaAction(e){!0===e&&this.setState({captcha:!0})}render(){const{isDisplay:e,goToProfile:t,token:s,firstName:o,lastName:r,CameFromPost:i,goToProduct:n,setPassword:d,registerExtraFields:m,getPassword:u,internationalCode:g,enterActivationCodeMode:v,internationalCodeClass:f,goToCheckout:N,goToChat:j,loginMethod:C,extraFields:b,timer:y,passwordAuthentication:w}=this.state,{t:k,fromPage:P}=this.props;return s&&n?(this.fc(!1),(0,p.jsx)(l.Fg,{to:"/submit-order/"+n})):s&&N&&o&&r&&!d?((0,c.TJ)({goToCheckout:!1}),(0,p.jsx)(l.Fg,{to:"/checkout/"})):s&&!N&&P&&!d?((0,c.TJ)({goToCheckout:!1}),(0,p.jsx)(l.Fg,{to:P+"/"})):s&&j?((0,c.TJ)({goToChat:!1}),(0,p.jsx)(l.Fg,{to:"/chat/"})):s&&i&&!d?(this.fd(!1),(0,p.jsx)(l.Fg,{to:"/add-new-post/publish"})):s&&!i&&!d&&o&&r||t?(0,p.jsx)(l.Fg,{to:"/profile"}):(0,p.jsxs)(a.NX,{className:"login-register-form-inside",flush:!0,children:[e&&(0,p.jsx)(a.WI,{className:"p-3",children:(0,p.jsx)(a.X2,{children:(0,p.jsx)(a.JX,{children:(0,p.jsxs)(a.l0,{onSubmit:this.handleRegister,children:[(0,p.jsx)(a.X2,{form:!0,children:(0,p.jsxs)(a.JX,{md:"12",className:"form-group ltr",children:[(0,p.jsx)("label",{htmlFor:"thepho",children:k("phone number")}),(0,p.jsxs)(a.BZ,{className:"mb-3",children:[(0,p.jsx)(a.wF,{type:"prepend",children:(0,p.jsx)(a.ih,{onChange:e=>this.setState({countryCode:e.target.value}),children:(0,p.jsx)("option",{value:"98",children:"+98"})})}),(0,p.jsx)(a.yt,{placeholder:"",id:"thepho",className:"iuygfghuji ltr",type:"tel",dir:"ltr",onChange:e=>this.setState({phoneNumber:e.target.value})})]})]})}),(0,p.jsx)(a.X2,{form:!0}),(0,p.jsx)(a.zx,{block:!0,type:"submit",className:"center",onClick:this.handleRegister,children:k("get enter code")})]})})})}),v&&(0,p.jsx)(a.WI,{className:"p-3",children:(0,p.jsx)(a.X2,{children:(0,p.jsx)(a.JX,{children:(0,p.jsxs)(a.l0,{onSubmit:this.handleActivation,children:[(0,p.jsx)(a.X2,{form:!0,children:(0,p.jsxs)(a.JX,{md:"12",className:"form-group",children:[(0,p.jsxs)("div",{className:"your-phone-number d-flex justify-content-sb",children:[(0,p.jsx)("div",{className:"flex-item ",children:k("your phone number")+":"}),(0,p.jsx)("div",{className:"flex-item ltr",children:"+"+this.state.countryCode+this.state.thePhoneNumber})]}),(0,p.jsx)("div",{className:"your-timer",children:(0,p.jsx)("div",{className:"flex-item ",children:Boolean(y)&&(0,p.jsxs)("div",{className:"flex-item-relative center ",children:[(0,p.jsx)(h.Z,{className:"red-progress",thickness:2,size:120,variant:"determinate",value:parseInt(100*y/x)}),(0,p.jsx)("div",{className:"flex-item-absolute ",children:y})]})})}),(0,p.jsx)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"start"},children:(0,p.jsx)("label",{style:{fontSize:12},htmlFor:"feEmailAddress",children:k("enter sent code")})}),(0,p.jsx)(a.BZ,{className:"mb-3",children:(0,p.jsx)(a.yt,{placeholder:"_ _ _ _ _ _",type:"number",className:"iuygfghuji ltr",dir:"ltr",onChange:e=>{this.setState({activationCode:e.target.value})}})})]})}),(0,p.jsx)(a.X2,{form:!0,children:(0,p.jsx)(a.JX,{md:"12",className:"form-group"})}),(0,p.jsx)(a.zx,{block:!0,type:"submit",className:"center",onClick:this.handleActivation,children:k("login")}),(0,p.jsx)(a.zx,{outline:!0,type:"button",className:"center btn-block outline the-less-important",onClick:this.handleWrongPhoneNumber,children:k("Wrong phone number?")}),Boolean(!y)&&(0,p.jsx)("div",{className:"flex-item-relative center ",children:(0,p.jsx)(a.zx,{outline:!0,type:"button",className:"center btn-block outline the-less-important the-no-border",onClick:e=>this.handleRegister(e),children:k("Send code again?")})})]})})})}),d&&(0,p.jsx)(a.WI,{className:"p-3",children:(0,p.jsx)(a.X2,{children:(0,p.jsx)(a.JX,{children:(0,p.jsxs)(a.l0,{onSubmit:this.savePasswordAndData,children:[(0,p.jsxs)(a.X2,{form:!0,children:[(0,p.jsxs)(a.JX,{md:"12",className:"form-group",children:[(0,p.jsx)("label",{htmlFor:"olfirstname",children:k("Your first name")}),(0,p.jsx)(a.BZ,{className:"mb-3",children:(0,p.jsx)(a.yt,{placeholder:k("First name (persian)"),type:"text",id:"olfirstname",dir:"rtl",value:o,onChange:e=>this.setState({firstName:e.target.value})})})]}),(0,p.jsxs)(a.JX,{md:"12",className:"form-group",children:[(0,p.jsx)("label",{htmlFor:"ollastname",children:k("Your last name")}),(0,p.jsx)(a.BZ,{className:"mb-3",children:(0,p.jsx)(a.yt,{placeholder:k("Last name (persian)"),type:"text",value:r,id:"ollastname",dir:"rtl",onChange:e=>this.setState({lastName:e.target.value})})})]}),m&&m.map((e=>"internationalCode"==(null===e||void 0===e?void 0:e.name)?(0,p.jsxs)(a.JX,{md:"12",className:"form-group "+f,children:[(0,p.jsx)("label",{htmlFor:"internationalCode",children:k("International Code")}),(0,p.jsx)(a.BZ,{className:"mb-3",children:(0,p.jsx)(a.yt,{className:"iuygfghuji ltr",placeholder:k("xxxxxxxxxx"),type:"number",value:g,id:"internationalCode",dir:"ltr",onChange:t=>{let s=b;s[null===e||void 0===e?void 0:e.name]=t.target.value,this.setState({internationalCode:t.target.value,internationalCodeClass:(0,c.zu)(t.target.value),extraFields:{...s}})}})})]}):(0,p.jsxs)(a.JX,{md:"12",className:"form-group",children:[(0,p.jsx)("label",{htmlFor:"ollastname",children:null===e||void 0===e?void 0:e.label}),(0,p.jsx)(a.BZ,{className:"mb-3",children:(0,p.jsx)(a.yt,{placeholder:null===e||void 0===e?void 0:e.label,type:"text",value:b[null===e||void 0===e?void 0:e.name],id:"ollastname",dir:"rtl",onChange:t=>{let s=b;s[null===e||void 0===e?void 0:e.name]=t.target.value,this.setState({extraFields:{...s}})}})})]}))),w&&(0,p.jsxs)(a.JX,{md:"12",className:"form-group",children:[(0,p.jsx)("label",{htmlFor:"oiuytpaswword",children:k("set new password")}),(0,p.jsx)(a.BZ,{className:"mb-3",children:(0,p.jsx)(a.yt,{placeholder:"******",type:"password",id:"oiuytpaswword",dir:"ltr",onChange:e=>this.setState({password:e.target.value})})})]})]}),(0,p.jsx)(a.X2,{form:!0,children:(0,p.jsx)(a.JX,{md:"12",className:"form-group"})}),(0,p.jsx)(a.zx,{type:"submit",className:"center btn-block",onClick:this.savePasswordAndData,children:k("Register")}),(0,p.jsx)(a.zx,{type:"submit",className:"center btn-block",onClick:c.RD,children:k("Logout")})]})})})}),u&&(0,p.jsx)(a.WI,{className:"p-3",children:(0,p.jsx)(a.X2,{children:(0,p.jsx)(a.JX,{children:(0,p.jsxs)(a.l0,{onSubmit:this.handlePassword,children:[(0,p.jsx)(a.X2,{form:!0,children:(0,p.jsxs)(a.JX,{md:"12",className:"form-group",children:[(0,p.jsx)("div",{className:"your-phone-number d-flex justify-content-sb",children:(0,p.jsx)("div",{className:"mb-2 flex-item",children:k("You registered before, please enter your password.")})}),(0,p.jsxs)("div",{className:"your-phone-number d-flex justify-content-sb",children:[(0,p.jsx)("div",{className:"flex-item ",children:k("your phone number")+":"}),(0,p.jsx)("div",{className:"flex-item ltr",children:"+"+this.state.countryCode+this.state.thePhoneNumber})]}),(0,p.jsx)("label",{htmlFor:"oiuytgpaswword",children:k("Enter password")}),(0,p.jsx)(a.BZ,{className:"mb-3",children:(0,p.jsx)(a.yt,{placeholder:"******",type:"password",id:"oiuytgpaswword",dir:"ltr",onChange:e=>this.setState({password:e.target.value})})})]})}),(0,p.jsx)(a.X2,{form:!0,children:(0,p.jsx)(a.JX,{md:"12",className:"form-group"})}),(0,p.jsx)(a.zx,{block:!0,type:"submit",className:"center",onClick:this.handlePassword,children:k("Login")}),(0,p.jsx)(a.zx,{type:"button",className:"center btn-block",onClick:this.handleForgotPass,children:k("Forgot Password")}),(0,p.jsx)(a.zx,{outline:!0,type:"button",className:"center btn-block outline the-less-important",onClick:this.handleWrongPhoneNumber,children:k("Wrong phone number?")})]})})})})]})}}const v=(0,o.Zh)()(g);function f(){const{t:e}=(0,o.$G)(),[t]=(0,r.lr)(),s=(0,l.UO)(),n=t.get("fromPage");return"goToCheckout"===s._state&&(0,c.TJ)({goToCheckout:!0}),"goToChat"===s._state&&(0,c.TJ)({goToChat:!0}),(0,p.jsxs)(a.W2,{fluid:!0,className:"main-content-container px-4",children:[(0,p.jsx)(a.X2,{noGutters:!0,className:"page-header py-4",children:(0,p.jsx)(i.Z,{sm:"12",title:e("login / register"),subtitle:e("user account"),className:"text-sm-left"})}),(0,p.jsx)("div",{className:"w-100 login-register-form-wrapper",children:(0,p.jsx)(a.JX,{lg:"4",className:"mx-auto mb-4",children:(0,p.jsx)(a.Zb,{children:(0,p.jsx)(v,{goToCheckout:"goToCheckout"===s._state,fromPage:n})})})})]})}}}]);